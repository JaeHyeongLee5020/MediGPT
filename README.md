# 🤖 MediGPT: AI 진단 기반 의약품 E-Commerce 플랫폼

### 1. 프로젝트 개요

**MediGPT**는 사용자가 자신의 건강 증상을 입력하면 **OpenAI의 GPT-3.5 모델**이 이를 분석하여 **AI 진단 결과와 추천 의약품을 제공**하고, 연동된 **E-Commerce(쇼핑몰) 플랫폼**에서 해당 의약품을 바로 구매까지 할 수 있는 원스톱 헬스케어 서비스입니다.

단순한 CRUD 게시판을 넘어, **외부 AI API 연동**, **결제 시스템(카카오페이)**, **하이브리드 데이터베이스 설계**, **실시간 비동기 처리** 등 최신 웹 개발의 다양한 기술적 요소를 깊이 있게 다룬 프로젝트입니다.

---

### 2. 핵심 기능

* **🩺 AI 증상 상담**: GPT-3.5 모델을 연동하여 사용자의 증상에 대한 AI 진단 및 추천 약품 목록을 제공합니다. (텍스트 및 **음성 인식** 입력 지원)
* **💊 의약품 쇼핑몰**: AI가 추천한 약품을 포함, 다양한 의약품을 검색, 정렬하고 상세 정보를 확인할 수 있습니다.
* **🛒 장바구니 및 결제**: `fetch` API를 활용한 비동기 장바구니 기능과 **아임포트(I'mport)**를 연동한 **카카오페이 결제** 기능을 제공합니다.
* **👤 사용자 시스템**: 회원가입, 로그인, 로그아웃 및 내 정보 수정, 프로필 사진 업로드, 진료 기록/결제 내역 조회 기능을 제공합니다.
* **📜 AI 처방전 & 영수증**: AI 진단 결과를 바탕으로 QR 코드가 포함된 동적 처방전을 생성하고, 결제 완료 후 영수증을 발급합니다.
* **🔐 관리자 기능**: 관리자 계정으로만 접근 가능한 약품 등록 및 관리 페이지를 구현했습니다.

---

### 3. 사용한 기술 (Tech Stack)

| 구분              | 기술                               | 세부 내용                                                                                              |
| :---------------- | :--------------------------------- | :----------------------------------------------------------------------------------------------------- |
| **Backend** | Java, Spring Boot                  | RESTful API, MVC 패턴 기반의 웹 애플리케이션 구축                                                      |
| **Frontend** | JSP, JSTL, Vanilla JS (ES6+)       | 서버 사이드 렌더링 및 `fetch` API를 이용한 비동기 통신                                                 |
|                   | jQuery, Bootstrap 5, Font Awesome  | 일부 동적 기능 및 반응형 UI/UX 디자인                                                                  |
| **Database** | **(Hybrid)** RDBMS + Firebase      | **Spring Data JPA**와 **Firebase Realtime DB**를 함께 사용하여 데이터 특성에 맞는 최적의 저장소 설계 |
| **Infra & Cloud** | Google Cloud Storage, Gradle       | 이미지 파일 저장 및 프로젝트 빌드 자동화                                                               |
| **External APIs** | OpenAI (GPT-3.5), KakaoPay (아임포트) | AI 기능 구현 및 실제 결제 시스템 연동                                                                  |

---

### 4. 시스템 아키텍처

MediGPT는 효율적인 3-Tier 아키텍처를 기반으로 설계되었습니다.
[ 사용자 (Client) ]
(웹 브라우저: JSP, JS, Bootstrap)
↑ |
| HTTP Requests (사용자 요청)
↓ |
[ 웹 서버 (Server) ]
(Spring Boot, Java)

Controller: 요청/응답 처리

Service: 비즈니스 로직, 외부 API 호출

Repository: 데이터 접근
↑ |
| API Calls & DB Queries
↓ |
[ 외부 서비스 & 데이터베이스 ]

OpenAI API (AI 진단)

KakaoPay API (결제)

Google Cloud Storage (이미지 저장)

Firebase DB (실시간 데이터)

RDBMS (정형 데이터)


---

### 5. 겪었던 문제 및 해결 과정 (Troubleshooting)

#### ① Firebase의 비동기(Asynchronous) 데이터 처리 문제 해결

* **문제점**: Firebase는 데이터를 비동기 방식으로 응답하기 때문에, 서비스 로직에서 데이터를 요청한 뒤 미처 받기도 전에 다음 코드가 실행되어 NullPointerException이 발생하거나 데이터 정합성이 깨지는 문제가 있었습니다.
* **해결 과정**: Java의 동시성 처리 유틸리티인 **`CountDownLatch`**를 도입했습니다. Firebase에 데이터를 요청하기 직전 Latch를 생성하고, Firebase의 `onDataChange` 콜백 메소드(데이터 수신 완료 시점)에서 Latch의 카운트를 감소시켰습니다. 메인 스레드는 `latch.await()`를 통해 Latch의 카운트가 0이 될 때까지 대기하도록 하여, **데이터를 완전히 수신한 후에야 다음 로직이 실행되도록 보장**할 수 있었습니다. 이를 통해 비동기 통신을 안정적인 동기식 흐름처럼 제어하여 데이터의 정합성과 서비스 안정성을 확보했습니다.

#### ② 데이터 특성을 고려한 하이브리드(Hybrid) DB 설계

* **문제점**: 프로젝트의 데이터는 실시간 동기화가 중요한 장바구니, 진단 기록과 정형적인 구조를 가진 게시글, 회원 정보가 혼재되어 있었습니다. 단일 데이터베이스로는 모든 요구사항을 만족시키기 어려웠습니다.
* **해결 과정**: 데이터의 성격에 따라 저장소를 분리하는 하이브리드 설계를 채택했습니다.
    * **Firebase Realtime DB**: 빠른 응답성과 실시간 동기화 능력이 필수적인 **장바구니, 사용자별 진단/결제 내역, 상품 정보** 관리에 사용했습니다.
    * **RDBMS + Spring Data JPA**: 트랜잭션 관리가 중요하고 명확한 스키마를 가진 **게시판, 회원 정보** 등 정형 데이터를 안정적으로 관리하기 위해 사용했습니다.
    * 이러한 설계를 통해 각 데이터의 특성에 맞는 최적의 성능과 안정성을 모두 확보할 수 있었습니다.
